var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.signFile=exports.convertFilesToBase64=exports.analyzeFile=exports.buildVideoFileSelector=exports.buildFileSelector=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var buildFileSelector=function buildFileSelector(){try{var fileSelector=document.createElement('input');fileSelector.setAttribute('type','file');fileSelector.setAttribute('accept','image/*');fileSelector.setAttribute('multiple','multiple');fileSelector.setAttribute('name','UploadImageInput');fileSelector.setAttribute('capture','environment');return fileSelector;}catch(e){console.log('Must be in a browser');return null;}};exports.buildFileSelector=buildFileSelector;var buildVideoFileSelector=function buildVideoFileSelector(){try{var fileSelector=document.createElement('input');fileSelector.setAttribute('type','file');fileSelector.setAttribute('accept','video/*');fileSelector.setAttribute('multiple','multiple');fileSelector.setAttribute('name','UploadVideoInput');fileSelector.setAttribute('capture','environment');return fileSelector;}catch(e){console.log('Must be in a browser');return null;}};exports.buildVideoFileSelector=buildVideoFileSelector;var analyzeFile=function analyzeFile(file){return new Promise(function(resolve,reject){try{var fileReader=new FileReader();fileReader.onload=function(e){var image=new Image();image.onload=function(){resolve({height:image.height,width:image.width,uri:e.target.result,aspectRatio:image.width/image.height});};image.src=e.target.result;};fileReader.readAsDataURL(file);}catch(e){reject(e);}});};exports.analyzeFile=analyzeFile;var convertFilesToBase64=function convertFilesToBase64(files){var filesWithBase64URI;return _regenerator.default.async(function convertFilesToBase64$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regenerator.default.awrap(Promise.all(files.map(function _callee(file){var _await$analyzeFile,uri,height,width,aspectRatio;return _regenerator.default.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regenerator.default.awrap(analyzeFile(file));case 2:_await$analyzeFile=_context.sent;uri=_await$analyzeFile.uri;height=_await$analyzeFile.height;width=_await$analyzeFile.width;aspectRatio=_await$analyzeFile.aspectRatio;file.uri=uri;file.height=height;file.width=width;file.aspectRatio=aspectRatio;return _context.abrupt("return",file);case 12:case"end":return _context.stop();}}},null,null,null,Promise);})));case 2:filesWithBase64URI=_context2.sent;return _context2.abrupt("return",filesWithBase64URI);case 4:case"end":return _context2.stop();}}},null,null,null,Promise);};exports.convertFilesToBase64=convertFilesToBase64;var signFile=function signFile(file){return function _callee2(createPresignedUrl){var input,_response$data,_response$data$Create,_response$data2,_response$data2$Creat,_response$data3,_response$data3$Creat,response,presignedUrl,url,id;return _regenerator.default.async(function _callee2$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log({file:file});input={filename:file.name,fileType:file.type};console.log({input:input});_context3.prev=3;_context3.next=6;return _regenerator.default.awrap(createPresignedUrl({variables:{input:input}}));case 6:response=_context3.sent;console.log({response:response});presignedUrl=response==null?void 0:(_response$data=response.data)==null?void 0:(_response$data$Create=_response$data.CreatePresignedUrl)==null?void 0:_response$data$Create.presignedUrl;url=response==null?void 0:(_response$data2=response.data)==null?void 0:(_response$data2$Creat=_response$data2.CreatePresignedUrl)==null?void 0:_response$data2$Creat.url;id=response==null?void 0:(_response$data3=response.data)==null?void 0:(_response$data3$Creat=_response$data3.CreatePresignedUrl)==null?void 0:_response$data3$Creat.id;file.id=id;file.presignedUrl=presignedUrl;file.url=url;return _context3.abrupt("return",file);case 17:_context3.prev=17;_context3.t0=_context3["catch"](3);console.log({signFileError:_context3.t0});case 20:case"end":return _context3.stop();}}},null,null,[[3,17]],Promise);};};exports.signFile=signFile;