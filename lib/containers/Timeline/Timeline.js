var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.Timeline=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _react=_interopRequireDefault(require("react"));var _FlatList=_interopRequireDefault(require("react-native-web/dist/exports/FlatList"));var _Platform=_interopRequireDefault(require("react-native-web/dist/exports/Platform"));var _Post=_interopRequireDefault(require("../../components/Post"));var _theme=require("../../theme");var _state=require("../../state");var _queries=require("../../queries");var _reactHooks=require("@apollo/react-hooks");var _this=this,_jsxFileName="/Users/kane/Lab/Eros/src/containers/Timeline/Timeline.js";var Timeline=function Timeline(_ref){var persona=_ref.persona,handle=_ref.handle,posts=_ref.posts,following=_ref.following,onLoadMore=_ref.onLoadMore,subscribeToNewPosts=_ref.subscribeToNewPosts,rest=(0,_objectWithoutProperties2.default)(_ref,["persona","handle","posts","following","onLoadMore","subscribeToNewPosts"]);var _useDimensions=(0,_state.useDimensions)(),width=_useDimensions.width,mobile=_useDimensions.mobile;var _useMutation=(0,_reactHooks.useMutation)(_queries.SET_NAV_DOCKED),_useMutation2=(0,_slicedToArray2.default)(_useMutation,1),setNavDocked=_useMutation2[0];var styles=(0,_theme.makeStyles)();var _useTheme=(0,_theme.useTheme)(),_useTheme2=(0,_slicedToArray2.default)(_useTheme,1),_useTheme2$=_useTheme2[0],gutter=_useTheme2$.gutter,FEED_WIDTH=_useTheme2$.FEED_WIDTH;var onScroll=function onScroll(e){if(e.nativeEvent.contentOffset.y===0){return setNavDocked({variables:{docked:true}});}return setNavDocked({variables:{docked:false}});};var onEndReached=function onEndReached(e){return _regenerator.default.async(function onEndReached$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log('END_REACHED e',e);_context.next=3;return _regenerator.default.awrap(onLoadMore());case 3:case"end":return _context.stop();}}},null,null,null,Promise);};var style={width:_Platform.default.OS==='web'?'100%':width-gutter*2,maxWidth:FEED_WIDTH,marginBottom:gutter,marginHorizontal:_Platform.default.OS==='web'&&gutter};return _react.default.createElement(_FlatList.default,(0,_extends2.default)({data:posts,renderItem:function renderItem(_ref2){var item=_ref2.item;return _react.default.createElement(_Post.default,(0,_extends2.default)({},item,{persona:persona,style:style,mobile:mobile,width:width,__self:_this,__source:{fileName:_jsxFileName,lineNumber:46,columnNumber:9}}));},onScroll:onScroll,onScrollEventThrottle:16,onEndReached:onEndReached,onEndReachedThreshold:0.75,keyExtractor:function keyExtractor(_ref3){var id=_ref3.id;return id;},contentContainerStyle:styles.contentContainer,style:styles.timeline},rest,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:43,columnNumber:5}}));};exports.Timeline=Timeline;var useStyles=(0,_theme.makeStyles)(function(theme){return{timeline:{flex:1,width:'100%'},contentContainer:{alignItems:'center',width:'100%'}};});var _default=Timeline;exports.default=_default;