var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.CreateForum=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _components=require("../../components");var _queries=require("../../queries");var _reactHooks=require("@apollo/react-hooks");var _theme=require("../../theme");var _this=this,_jsxFileName="/Users/kane/Lab/Eros/src/containers/Forum/CreateForum.js";var INITIAL_STATE={url:'',title:''};var SET_URL='SET_URL';var SET_TITLE='SET_TITLE';var RESET='RESET';var reducer=function reducer(state,action){switch(action.type){case SET_URL:return(0,_extends2.default)({},state,{url:action.payload});case SET_TITLE:return(0,_extends2.default)({},state,{title:action.payload});case RESET:return INITIAL_STATE;default:return state;}};var CreateForum=function CreateForum(_ref){var initialUrl=_ref.url,_ref$onSuccess=_ref.onSuccess,onSuccess=_ref$onSuccess===void 0?function(){return null;}:_ref$onSuccess;var _useReducer=(0,_react.useReducer)(reducer,(0,_extends2.default)({},INITIAL_STATE,{url:initialUrl})),_useReducer2=(0,_slicedToArray2.default)(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var _useMutation=(0,_reactHooks.useMutation)(_queries.CREATE_FORUM),_useMutation2=(0,_slicedToArray2.default)(_useMutation,2),createForum=_useMutation2[0],_useMutation2$=_useMutation2[1],error=_useMutation2$.error,loading=_useMutation2$.loading;var styles=useStyles();(0,_react.useEffect)(function(){return function(){return dispatch({type:RESET});};},[]);var onChangeUrl=function onChangeUrl(nextUrl){return dispatch({type:SET_URL,payload:nextUrl});};var onChangeTitle=function onChangeTitle(nextTitle){return dispatch({type:SET_TITLE,payload:nextTitle});};var onSubmit=function onSubmit(){var _url,_title,input,options,_await$createForum,data;return _regenerator.default.async(function onSubmit$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_url=state.url,_title=state.title;input={url:_url,title:_title};options={variables:{input:input}};_context.next=6;return _regenerator.default.awrap(createForum(options));case 6:_await$createForum=_context.sent;data=_await$createForum.data;if(!(data&&data.CreateForum)){_context.next=10;break;}return _context.abrupt("return",onSuccess(data.CreateForum));case 10:_context.next=15;break;case 12:_context.prev=12;_context.t0=_context["catch"](0);console.log(_context.t0);case 15:case"end":return _context.stop();}}},null,null,[[0,12]],Promise);};var url=state.url,title=state.title;return _react.default.createElement(_components.Container,{center:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:64,columnNumber:5}},_react.default.createElement(_components.Paper,{style:styles.paper,__self:_this,__source:{fileName:_jsxFileName,lineNumber:65,columnNumber:7}},_react.default.createElement(_components.Title,{type:6,text:"Create Forum",gutter:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:66,columnNumber:9}}),error&&_react.default.createElement(_components.Subtitle,{text:error.message,gutter:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:67,columnNumber:19}}),loading&&_react.default.createElement(_components.ActivityIndicator,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:68,columnNumber:21}}),_react.default.createElement(_components.Subtitle,{gutter:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:70,columnNumber:9}},"Name"),_react.default.createElement(_components.TextField,{value:url,onChangeText:onChangeUrl,style:styles.textField,__self:_this,__source:{fileName:_jsxFileName,lineNumber:71,columnNumber:9}}),_react.default.createElement(_components.Subtitle,{gutter:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:72,columnNumber:9}},"Title"),_react.default.createElement(_components.TextField,{value:title,onChangeText:onChangeTitle,style:styles.textField,__self:_this,__source:{fileName:_jsxFileName,lineNumber:73,columnNumber:9}}),_react.default.createElement(_components.OutlinedButton,{onPress:onSubmit,text:"SUBMIT",__self:_this,__source:{fileName:_jsxFileName,lineNumber:75,columnNumber:9}})));};exports.CreateForum=CreateForum;var useStyles=(0,_theme.makeStyles)(function(theme){return{paper:{padding:theme.unit*2},textField:{marginBottom:theme.unit*1.5}};});var _default=CreateForum;exports.default=_default;