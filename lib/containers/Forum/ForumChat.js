var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.ForumChat=exports.ChatList=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _components=require("../../components");var _reactNative=require("react-native");var _queries=require("../../queries");var _reactHooks=require("@apollo/react-hooks");var _theme=require("../../theme");var _ForumMembersList=_interopRequireDefault(require("./ForumMembersList"));var _ForumChatInput=_interopRequireDefault(require("./ForumChatInput"));var _ForumMember=_interopRequireDefault(require("./ForumMember"));var _this=this,_jsxFileName="/Users/kane/Lab/Eros/src/containers/Forum/ForumChat.js";var ChatList=function ChatList(_ref){var _ref$data=_ref.data,data=_ref$data===void 0?[]:_ref$data;return _react.default.createElement(_components.List,{dense:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:24,columnNumber:3}},data.map(function(_ref2){var message=_ref2.message;return _react.default.createElement(_components.ListItem,{dense:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:26,columnNumber:7}},_react.default.createElement(_components.ListItemText,{text:message,__self:_this,__source:{fileName:_jsxFileName,lineNumber:27,columnNumber:9}}));}));};exports.ChatList=ChatList;var ForumChat=function ForumChat(_ref3){var forumId=_ref3.forumId;var _useQuery=(0,_reactHooks.useQuery)(_queries.DRAWER),drawerOpen=_useQuery.data.Drawer.open;var _useState=(0,_react.useState)([]),_useState2=(0,_slicedToArray2.default)(_useState,2),chatList=_useState2[0],setChatList=_useState2[1];var _useState3=(0,_react.useState)(0),_useState4=(0,_slicedToArray2.default)(_useState3,2),index=_useState4[0],setIndex=_useState4[1];var _useState5=(0,_react.useState)(null),_useState6=(0,_slicedToArray2.default)(_useState5,2),selectedMember=_useState6[0],setSelectedMember=_useState6[1];var onSubscriptionData=function onSubscriptionData(_ref4){var subscriptionData=_ref4.subscriptionData;return setChatList(function(state){return[].concat((0,_toConsumableArray2.default)(state),[subscriptionData.data.ForumChat]);});};var options={variables:{forumId:forumId},shouldResubscribe:true,onSubscriptionData:onSubscriptionData};(0,_reactHooks.useSubscription)(_queries.FORUM_CHAT,options);var onPressMember=function onPressMember(member){setSelectedMember(member);setIndex(2);};console.log('chatList',chatList);var _renderStep=function _renderStep(){switch(index){case 0:return _react.default.createElement(ChatList,{data:chatList,__self:_this,__source:{fileName:_jsxFileName,lineNumber:56,columnNumber:16}});case 1:return _react.default.createElement(_ForumMembersList.default,{forumId:forumId,onPressMember:onPressMember,__self:_this,__source:{fileName:_jsxFileName,lineNumber:58,columnNumber:16}});case 2:return _react.default.createElement(_ForumMember.default,(0,_extends2.default)({},selectedMember,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:60,columnNumber:16}}));default:throw'Unexpected Index';}};var goBack=function goBack(){return setIndex(function(last){return last-1;});};var styles=useStyles();return _react.default.createElement(_components.Paper,{style:styles.paper,__self:_this,__source:{fileName:_jsxFileName,lineNumber:71,columnNumber:5}},_react.default.createElement(_components.View,{style:styles.forumChatHeader,__self:_this,__source:{fileName:_jsxFileName,lineNumber:72,columnNumber:7}},index===0?_react.default.createElement(_components.View,{style:{height:_theme.NAV_HEIGHT,width:_theme.NAV_HEIGHT},__self:_this,__source:{fileName:_jsxFileName,lineNumber:74,columnNumber:11}}):_react.default.createElement(_components.IconButton,{name:"ios-arrow-round-back",onPress:goBack,__self:_this,__source:{fileName:_jsxFileName,lineNumber:76,columnNumber:11}}),_react.default.createElement(_components.Subtitle,{type:6,text:index===0?'Forum Chat':'Members',__self:_this,__source:{fileName:_jsxFileName,lineNumber:79,columnNumber:9}}),index===1?_react.default.createElement(_components.View,{style:{height:_theme.NAV_HEIGHT,width:_theme.NAV_HEIGHT},__self:_this,__source:{fileName:_jsxFileName,lineNumber:81,columnNumber:11}}):_react.default.createElement(_components.IconButton,{name:"ios-contacts",onPress:function onPress(){return setIndex(1);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:83,columnNumber:11}})),_react.default.createElement(_components.Container,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:86,columnNumber:7}},_renderStep()),_react.default.createElement(_ForumChatInput.default,{forumId:forumId,__self:_this,__source:{fileName:_jsxFileName,lineNumber:87,columnNumber:7}}));};exports.ForumChat=ForumChat;var useStyles=(0,_theme.makeStyles)(function(theme){return{paper:{width:'100%',maxWidth:270,borderRadius:0,borderTopWidth:0,borderBottomWidth:0,borderRightWidth:0},forumChatHeader:{width:'100%',height:_theme.NAV_HEIGHT,flexDirection:'row',justifyContent:'space-between',alignItems:'center'}};});var _default=ForumChat;exports.default=_default;