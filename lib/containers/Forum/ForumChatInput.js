var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.ForumChatInput=exports.ForumChatInputButtons=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _components=require("../../components");var _queries=require("../../queries");var _reactHooks=require("@apollo/react-hooks");var _theme=require("../../theme");var _this=this,_jsxFileName="/Users/kane/Lab/Eros/src/containers/Forum/ForumChatInput.js";var ForumChatInputButtons=function ForumChatInputButtons(_ref){var onSend=_ref.onSend,_ref$loading=_ref.loading,loading=_ref$loading===void 0?false:_ref$loading;var styles=useStyles();return _react.default.createElement(_components.View,{style:styles.chatInputButtons,__self:_this,__source:{fileName:_jsxFileName,lineNumber:10,columnNumber:5}},loading?_react.default.createElement(_components.ActivityIndicator,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:11,columnNumber:18}}):_react.default.createElement(_components.Button,{text:"SEND",onPress:onSend,__self:_this,__source:{fileName:_jsxFileName,lineNumber:11,columnNumber:42}}));};exports.ForumChatInputButtons=ForumChatInputButtons;var ForumChatInput=function ForumChatInput(_ref2){var forumId=_ref2.forumId;var _useState=(0,_react.useState)(''),_useState2=(0,_slicedToArray2.default)(_useState,2),message=_useState2[0],setMessage=_useState2[1];var styles=useStyles();var _useMutation=(0,_reactHooks.useMutation)(_queries.CREATE_FORUM_CHAT_MESSAGE),_useMutation2=(0,_slicedToArray2.default)(_useMutation,2),send=_useMutation2[0],_useMutation2$=_useMutation2[1],error=_useMutation2$.error,loading=_useMutation2$.loading;var onSend=function onSend(){var input,options,_await$send,data,messageReceived;return _regenerator.default.async(function onSend$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;input={forumId:forumId,message:message};options={variables:{input:input}};_context.next=5;return _regenerator.default.awrap(send(options));case 5:_await$send=_context.sent;data=_await$send.data;messageReceived=data&&data.CreateForumChatMessage;if(!messageReceived){_context.next=10;break;}return _context.abrupt("return",setMessage(''));case 10:_context.next=15;break;case 12:_context.prev=12;_context.t0=_context["catch"](0);console.log('e');case 15:case"end":return _context.stop();}}},null,null,[[0,12]],Promise);};return _react.default.createElement(_components.View,{style:styles.chatInputContainer,__self:_this,__source:{fileName:_jsxFileName,lineNumber:36,columnNumber:5}},_react.default.createElement(_components.Multiline,{value:message,onChangeText:setMessage,style:styles.chatInput,__self:_this,__source:{fileName:_jsxFileName,lineNumber:37,columnNumber:7}}),_react.default.createElement(ForumChatInputButtons,{onSend:onSend,loading:loading,__self:_this,__source:{fileName:_jsxFileName,lineNumber:38,columnNumber:7}}));};exports.ForumChatInput=ForumChatInput;var useStyles=(0,_theme.makeStyles)(function(theme){return{chatInputContainer:{paddingHorizontal:theme.unit,paddingBottom:theme.unit},chatInputButtons:{flexDirection:'row',marginTop:theme.unit*1.5,justifyContent:'flex-end'},chatInput:{backgroundColor:theme.textColor.faint,fontSize:14,lineHeight:21}};});var _default=ForumChatInput;exports.default=_default;