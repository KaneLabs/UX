var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _queries=require("../../queries");var _reactHooks=require("@apollo/react-hooks");var _state=require("../../state");var _theme=require("../../theme");var _KeyboardAwareContainer=_interopRequireDefault(require("../../components/KeyboardAwareContainer"));var _AuthPhoneOrEmail=_interopRequireDefault(require("./AuthPhoneOrEmail"));var _AuthSignup=_interopRequireDefault(require("./AuthSignup"));var _AuthVerifyPhone=_interopRequireDefault(require("./AuthVerifyPhone"));var _Saint_George1080x=_interopRequireDefault(require("../../assets/Saint_George-1080x1920.jpg"));var _this=this,_jsxFileName="/Users/kane/Lab/Eros/src/containers/Auth/Auth.js";var Auth=function Auth(_ref){var onSuccess=_ref.onSuccess,_ref$handle=_ref.handle,handle=_ref$handle===void 0?null:_ref$handle;var meQuery=(0,_reactHooks.useQuery)(_queries.ME);console.log('meQuery',meQuery);var _useQuery=(0,_reactHooks.useQuery)(_queries.ACCOUNT),accountData=_useQuery.data;var _useMutation=(0,_reactHooks.useMutation)(_queries.SET_ACCOUNT),_useMutation2=(0,_slicedToArray2.default)(_useMutation,1),setAccount=_useMutation2[0];var account=accountData&&accountData.account;var styles=useStyles();var _useState=(0,_react.useState)(0),_useState2=(0,_slicedToArray2.default)(_useState,2),stepIndex=_useState2[0],setStepIndex=_useState2[1];var _useDimensions=(0,_state.useDimensions)(),width=_useDimensions.width,height=_useDimensions.height;var onNext=function onNext(){return setStepIndex(function(last){return last+1;});};var onBack=function onBack(){return setStepIndex(function(last){return last-1;});};var onVerifySuccess=function onVerifySuccess(account){onSuccess(account);};var onAccountSetupSuccess=function onAccountSetupSuccess(account){return _regenerator.default.async(function onAccountSetupSuccess$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log('onAccountSetupSuccess',{account:account});_context.next=3;return _regenerator.default.awrap(setAccount({variables:account}));case 3:return _context.abrupt("return",onSuccess(account));case 4:case"end":return _context.stop();}}},null,null,null,Promise);};var onSignupSuccess=function onSignupSuccess(account){return _regenerator.default.async(function onSignupSuccess$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(response==='We sent you a code.'){setStepIndex(2);}case 1:case"end":return _context2.stop();}}},null,null,null,Promise);};var handlePhoneOrEmail=function handlePhoneOrEmail(response){console.log(response==='We sent you a code.');if(response==='We sent you a code.'){setStepIndex(2);}};var _renderStep=function _renderStep(stepIndex){switch(stepIndex){case 0:return _react.default.createElement(_AuthPhoneOrEmail.default,{onSuccess:handlePhoneOrEmail,__self:_this,__source:{fileName:_jsxFileName,lineNumber:58,columnNumber:16}});case 1:return _react.default.createElement(_AuthSignup.default,{onBack:onBack,onSuccess:onSignupSuccess,__self:_this,__source:{fileName:_jsxFileName,lineNumber:60,columnNumber:16}});case 2:return _react.default.createElement(_AuthVerifyPhone.default,{onSuccess:onVerifySuccess,__self:_this,__source:{fileName:_jsxFileName,lineNumber:62,columnNumber:16}});default:return null;}};var sizeStyles=_reactNative.Platform.select({web:{width:'100%',maxWidth:_theme.FEED_WIDTH,height:'100%'},default:{width:width,height:height}});return _react.default.createElement(_reactNative.ImageBackground,{source:_Saint_George1080x.default,style:[styles.imageBackground,sizeStyles],__self:_this,__source:{fileName:_jsxFileName,lineNumber:74,columnNumber:5}},_react.default.createElement(_reactNative.SafeAreaView,{style:styles.safeAreaView,__self:_this,__source:{fileName:_jsxFileName,lineNumber:77,columnNumber:7}},_react.default.createElement(_KeyboardAwareContainer.default,{style:styles.container,__self:_this,__source:{fileName:_jsxFileName,lineNumber:78,columnNumber:9}},_renderStep(stepIndex))));};var useStyles=(0,_theme.makeStyles)(function(theme){return{blurredBackground:{flex:1,backdropFilter:"blur("+theme.unit*1+"px)",paddingVertical:theme.unit*3.5,paddingHorizontal:theme.unit*3.5,backgroundColor:'rgba(0,0,0,0.8)',alignItems:'center'},imageBackground:{flex:1},safeAreaView:{flex:1,backgroundColor:'rgba(0,0,0,0.85)'},container:{flex:1,maxWidth:theme.FEED_WIDTH,maxHeight:theme.FEED_WIDTH*(16/9),paddingVertical:theme.unit*3.5,paddingHorizontal:theme.unit*3.5,width:'100%',height:'100%',justifyContent:'center',alignItems:'center'},titleContainer:{width:'100%'}};});var _default=Auth;exports.default=_default;