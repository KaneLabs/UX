var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.PhoneAuth=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _components=require("../../components");var _queries=require("../../queries");var _reactHooks=require("@apollo/react-hooks");var _state=require("../../state");var _theme=require("../../theme");var _PhoneAuthSet=_interopRequireDefault(require("./PhoneAuthSet"));var _PhoneAuthVerify=_interopRequireDefault(require("./PhoneAuthVerify"));var _PhoneAuthClaimHandle=_interopRequireDefault(require("./PhoneAuthClaimHandle"));var _Saint_George1080x=_interopRequireDefault(require("../../assets/Saint_George-1080x1920.jpg"));var _this=this,_jsxFileName="/Users/kane/Lab/Eros/src/containers/PhoneAuth/PhoneAuth.js";var PhoneAuth=function PhoneAuth(_ref){var onSuccess=_ref.onSuccess,_ref$handle=_ref.handle,handle=_ref$handle===void 0?null:_ref$handle;var _useQuery=(0,_reactHooks.useQuery)(_queries.ACCOUNT),accountData=_useQuery.data;console.log('accountData',accountData);var _useMutation=(0,_reactHooks.useMutation)(_queries.SET_ACCOUNT),_useMutation2=(0,_slicedToArray2.default)(_useMutation,1),setAccount=_useMutation2[0];var account=accountData&&accountData.account;var _useState=(0,_react.useState)(0),_useState2=(0,_slicedToArray2.default)(_useState,2),stepIndex=_useState2[0],setStepIndex=_useState2[1];var _useDimensions=(0,_state.useDimensions)(),width=_useDimensions.width,height=_useDimensions.height;var onNext=function onNext(){return setStepIndex(function(last){return last+1;});};var onBack=function onBack(){return setStepIndex(function(last){return last-1;});};var onVerifySuccess=function onVerifySuccess(account){var hasAHandle;return _regenerator.default.async(function onVerifySuccess$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regenerator.default.awrap(setAccount({variables:account}));case 2:hasAHandle=account&&account.handle;if(!hasAHandle){_context.next=5;break;}return _context.abrupt("return",onSuccess(account));case 5:return _context.abrupt("return",onNext());case 6:case"end":return _context.stop();}}},null,null,null,Promise);};var onAccountSetupSuccess=function onAccountSetupSuccess(account){return _regenerator.default.async(function onAccountSetupSuccess$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log('onAccountSetupSuccess',{account:account});_context2.next=3;return _regenerator.default.awrap(setAccount({variables:account}));case 3:return _context2.abrupt("return",onSuccess(account));case 4:case"end":return _context2.stop();}}},null,null,null,Promise);};var onClaimNameSuccess=function onClaimNameSuccess(account){return _regenerator.default.async(function onClaimNameSuccess$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log('onClaimNameSuccess',{account:account});_context3.next=3;return _regenerator.default.awrap(setAccount({variables:account}));case 3:onNext();case 4:case"end":return _context3.stop();}}},null,null,null,Promise);};var _renderStep=function _renderStep(stepIndex){switch(stepIndex){default:return null;}};var styles=useStyles();var _useTheme=(0,_theme.useTheme)(),_useTheme2=(0,_slicedToArray2.default)(_useTheme,1),_useTheme2$=_useTheme2[0],FEED_WIDTH=_useTheme2$.FEED_WIDTH,unit=_useTheme2$.unit;var sizeStyles=_reactNative.Platform.select({web:{width:'100%',maxWidth:FEED_WIDTH,height:'100%'},default:{width:width,height:height}});return _react.default.createElement(_reactNative.ImageBackground,{source:_Saint_George1080x.default,style:[styles.imageBackground,sizeStyles],__self:_this,__source:{fileName:_jsxFileName,lineNumber:74,columnNumber:5}},_react.default.createElement(_reactNative.SafeAreaView,{style:styles.safeAreaView,__self:_this,__source:{fileName:_jsxFileName,lineNumber:75,columnNumber:7}},_react.default.createElement(_components.KeyboardAwareContainer,{style:styles.container,__self:_this,__source:{fileName:_jsxFileName,lineNumber:76,columnNumber:9}},handle&&_react.default.createElement(_components.View,{style:styles.titleContainer,__self:_this,__source:{fileName:_jsxFileName,lineNumber:78,columnNumber:13}},_react.default.createElement(_components.Title,{type:5,text:"@"+handle+" Is Available",gutter:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:79,columnNumber:15}})),_react.default.createElement(_PhoneAuthClaimHandle.default,{onSuccess:onClaimNameSuccess,__self:_this,__source:{fileName:_jsxFileName,lineNumber:82,columnNumber:11}}))));};exports.PhoneAuth=PhoneAuth;var useStyles=(0,_theme.makeStyles)(function(theme){return{blurredBackground:{flex:1,backgroundColor:'rgba(0,0,0,0.8)',alignItems:'center'},imageBackground:{flex:1},safeAreaView:{flex:1,backgroundColor:'rgba(0,0,0,0.85)'},container:{flex:1,maxWidth:theme.FEED_WIDTH,paddingVertical:theme.NAV_HEIGHT+theme.unit*2,paddingHorizontal:theme.unit*2,width:'100%',justifyContent:'center',alignItems:'center'},titleContainer:{width:'100%'}};});var _default=PhoneAuth;exports.default=_default;